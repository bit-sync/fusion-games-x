!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){var n=[];function s(e,t){var s,o;t?(n=JSON.parse(e.response),o=n,s=new TextEncoder("utf-8").encode(JSON.stringify(o)),self.postMessage({msg:"loaded remote data",data:s},[s.buffer])):(n=JSON.parse(e),self.postMessage({msg:"loaded local data"}))}function o(e,t){return e.Moves<t.Moves?-1:e.Moves>t.Moves?1:0}function r(e){var t=new RegExp("^"+e+".?"),s=n.filter((function(e){return t.test(e.Moves)}));return s.length>0&&s.map((function(e,t){return e.Moves=e.Moves.trim(),e})).sort(o),s.length>0?{opening:s[0],lines:s.slice(),sub:[]}:{opening:{Name:"N/A",Code:"N/A"},lines:[],sub:[]}}function i(e,t){let n=r(e);if(n.lines&&n.lines.length>0){let e=function(e=".*",t){var n=new RegExp(e,"i"),s=t.filter(e=>n.test(e.Name)),r=t.filter(e=>n.test(e.Variation));let i=[].concat(s,r);return i.length>0&&i.map(e=>e.Moves=e.Moves.trim()).sort(o),i.length>0?{opening:i[0],lines:i.slice()}:{opening:{Name:"N/A",Code:"N/A"},lines:[],sub:[]}}(t,n.lines.slice());if(e.lines&&e.lines.length>0)return{opening:e.opening,lines:n.lines,sub:e.lines}}return n.lines.length>0?{opening:n.lines[0],lines:n.lines,sub:[]}:{opening:{Name:"N/A",Code:"N/A"},lines:[],sub:[]}}self.addEventListener("message",(function(e){var t,n,o,a=e.data;switch(a.msg){case"start":"undefined"!==a.ECO&&""!==a.ECO?s((o=a.ECO,new TextDecoder("utf-8").decode(o)),!1):function(e,t,n){try{var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState<4||200===s.status&&4===s.readyState&&t(s,n)},s.open("GET",e,!0),s.send("")}catch(e){console.log("error with XHR object - browser unsupported")}}("../../json/ECO2.json",s,!0);break;case"get":t=r(a.move),self.postMessage({msg:"opening name",opening:t.opening,lines:t.lines});break;case"filter":t=i(a.move,a.keyword),self.postMessage({msg:"opening filter",opening:t.opening,lines:t.lines,filtered:t.sub||[]});break;case"get_totals":fetch("https://dbapi.chessui.com/db/totals.json",{mode:"cors"}).then(e=>{e.json().then(e=>{self.postMessage({msg:"got_totals",data:e})})}).catch(e=>{console.log("Error getting totals.")});break;case"book_get":let e=a.code,l=a.endCode;fetch(`https://gfhu009ssb.execute-api.us-east-1.amazonaws.com/sr?orderBy=%22eco%22&startAt=%22${e}%22&endAt=%22${l}%22`,{mode:"cors"}).then(e=>{e.json().then(e=>{self.postMessage({msg:"book_got",data:e})})}).catch(e=>{console.log("Error getting book.")});break;case"engine_get":n=i(a.move,a.keyword),self.postMessage({msg:"options",lines:n.lines,filtered:n.sub||[]});break;case"copy":s(a.ECO);break;default:self.postMessage({msg:"Err"})}}))}]);